<!-- All our projects begin with the project tag -->
<project name="Space Trader" default="all" basedir=".">

	<!-- our init target is a prereq for everything -->
	<target name="init">
		<property name = "src.dir" value = "src" />
		<property name = "build.dir" value = "build" />
		<property name = "apidoc.dir" value = "apidoc" />
		<property name="junit.jar" value="lib/junit.jar" />
		<property name="resources.jar" value="lib/resources.jar" />
		<property name="test.class" value="test.AntTest"/>
		<property name="junit.dir" value="junit-results"/>
		
		<path id="classpath">
		    <pathelement location="${build.dir}" />
			<pathelement location="${junit.jar}" />
			<pathelement location="${resources.jar}" />
		</path>
	</target>
	
	<!-- prepare is a prereq for most tasks except cleanup -->
	<target name="prepare" depends="init">
		<mkdir dir = "${build.dir}" />
		<mkdir dir = "${apidoc.dir}" />
		<mkdir dir="${junit.dir}"/>
	</target>
	
	<!-- compile the code -->
	<target name="compile" depends="prepare">
		<javac srcdir="${src.dir}" destdir="${build.dir}" includeantruntime="false">
			<classpath refid="classpath"/>
		</javac>
	</target>
	
	<!-- create the javadoc -->
	<target name="javadoc" depends="compile">
		<javadoc destdir="${apidoc.dir}" author="true" version="true">
			<classpath refid="classpath" />
			<packageset dir="${src.dir}" defaultexcludes="yes" />
		</javadoc>
	</target>

	<!-- run JUnit tests -->
	<target name="junit" depends="compile">
		<junit showoutput="true" printsummary="yes" fork="yes" haltonerror="yes" haltonfailure="yes">
			<classpath refid="classpath" />
			<test name="${test.class}" todir="${junit.dir}" />
			<formatter type="xml"/>
		</junit>
	</target>
	
	<!-- create the jar -->
	<target name="jar" depends="junit">
		<jar destfile="AntTestRun.jar" basedir="${build.dir}">
		    <manifest>
				<attribute name="Main-Class" value="edu.gatech.oad.antlab.pkg1.AntLabMain"/>
		        <attribute name="Class-Path" value="lib/resources.jar"/>
		    </manifest>
		  </jar>
	</target>
	
	<!-- run the application -->
	<target name="run" depends="jar">
		<java jar="AntTestRun.jar" fork="true" />
	</target>

	<!-- clean up all files generated by tshe build -->
	<target name="clean" depends="init">
		<delete dir="${build.dir}"/>
		<delete dir="${apidoc.dir}"/>
		<delete file="AntTestRun.jar"/>
		<delete dir="${junit.dir}"/>
	</target>
	
	<!-- run all tasks except cleanup -->
	<target name="all" depends="run" />

</project>